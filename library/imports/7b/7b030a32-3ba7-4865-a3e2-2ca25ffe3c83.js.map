{"version":3,"sources":["assets\\Script\\framewrok\\SoundManager.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import LocalStorage from \"./LocalStorage\";\r\n\r\nexport default class SoundManager\r\n{\r\n    private _musicVolume: number = 1;//背景音乐音量控制\r\n    private _musicMute: boolean = false;//是否背景音乐静音\r\n    private _effectVolume: number = 1;//音效音量控制\r\n    private _effectMute: boolean = false;//是否音效静音\r\n    private _curMusicId:number = 0;\r\n    \r\n    private static _instance:SoundManager;\r\n\r\n    public static get instance():SoundManager\r\n    {\r\n        if(this._instance == null)\r\n        {\r\n            this._instance = new SoundManager(); \r\n        }\r\n        return this._instance;\r\n    }\r\n\r\n    public setup()\r\n    {\r\n        if(LocalStorage.instance.getItem(\"musicVolume\"))\r\n        {\r\n            this.musicVolume = LocalStorage.instance.getItem(\"musicVolume\");\r\n        }\r\n        if(LocalStorage.instance.getItem(\"musicMute\"))\r\n        {\r\n            this.musicMute = LocalStorage.instance.getItem(\"musicMute\");\r\n        }\r\n        if(LocalStorage.instance.getItem(\"effectMute\"))\r\n        {\r\n            this.effectMute = LocalStorage.instance.getItem(\"effectMute\");\r\n        }\r\n        if(LocalStorage.instance.getItem(\"effectVolume\"))\r\n        {\r\n            this.effectVolume = LocalStorage.instance.getItem(\"effectVolume\");\r\n        }\r\n    }\r\n\r\n    public get musicMute(): boolean \r\n    {\r\n        return this._musicMute;\r\n    }\r\n    public set musicMute(value: boolean) \r\n    {\r\n        if (this._musicMute != value) {\r\n            LocalStorage.instance.setItem(\"musicMute\", value);\r\n            this._musicMute = value;\r\n            if (value)this.stopMusic();\r\n        }\r\n    }\r\n\r\n    public get effectMute(): boolean \r\n    {\r\n        return this._effectMute;\r\n    }\r\n    public set effectMute(value: boolean) \r\n    {\r\n        if (this._effectMute != value) \r\n        {\r\n            LocalStorage.instance.setItem(\"effectMute\", value);\r\n            this._effectMute = value;\r\n            if (value)this.stopAllEffect();\r\n        }\r\n    }\r\n\r\n    public get musicVolume(): number \r\n    {\r\n        return this._musicVolume;\r\n    }\r\n    public set musicVolume(value: number) \r\n    {\r\n        if(this._musicVolume != value)\r\n        {\r\n            LocalStorage.instance.setItem(\"musicVolume\", value);\r\n            this._musicVolume = value;\r\n            cc.audioEngine.setMusicVolume(value);\r\n        }\r\n    }\r\n\r\n    public get effectVolume(): number \r\n    {\r\n        return this._effectVolume;\r\n    }\r\n    public set effectVolume(value: number) \r\n    {\r\n        if(this._effectVolume != value)\r\n        {\r\n            LocalStorage.instance.setItem(\"effectVolume\", value);\r\n            this._effectVolume = value;\r\n            cc.audioEngine.setEffectsVolume(value);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 播放背景音乐\r\n     */\r\n    playMusic(url, loop) \r\n    {\r\n        if (this.musicMute) return;\r\n        cc.loader.loadRes(url, cc.AudioClip, function (err, clip) \r\n        {\r\n            if(err)\r\n            {\r\n                cc.error(\"play bgm error\");\r\n                return;\r\n            }\r\n            if (this._curMusicId) cc.audioEngine.stop(this._curMusicId);\r\n            this._curMusicId = cc.audioEngine.playMusic(clip, loop);\r\n        }.bind(this));\r\n    }\r\n\r\n    /**暂停播放背景音乐 */\r\n    pauseMusic() \r\n    {\r\n        cc.audioEngine.pauseMusic();\r\n    }\r\n\r\n    /**继续播放背景音乐 */\r\n    resumeMusic() \r\n    {\r\n        cc.audioEngine.resumeMusic();\r\n    }\r\n    /**停止背景音乐 */\r\n    stopMusic() \r\n    {\r\n        cc.audioEngine.stopMusic();\r\n    }\r\n\r\n    /**\r\n     * 播放音效\r\n     * @param audioName 音乐文件名称，不需要填文件后缀\r\n     * @param loop 是否循环播放\r\n     */\r\n    playEffect(url, loop) \r\n    {\r\n        loop = loop || false;\r\n        if (this.effectMute) return;\r\n        cc.loader.loadRes(url, cc.AudioClip, function (err, clip) \r\n        {\r\n            if(err)\r\n            {\r\n                cc.error(\"play bgm error\");\r\n                return;\r\n            }\r\n            cc.audioEngine.play(clip, loop, this.effectVolume);\r\n        }.bind(this));\r\n    }\r\n    \r\n    /**停止所有音效 */\r\n    stopAllEffect() \r\n    {\r\n        cc.audioEngine.stopAllEffects();\r\n    }\r\n}"]}