{"version":3,"sources":["assets\\Script\\framewrok\\utils\\LanguageMgr.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import SimpleDictionary from \"./SimpleDictionary\";\r\nimport { StringUtils } from \"./StringUtls\";\r\nimport GameConst from \"../../game/data/GameConst\";\r\n\r\n\r\nexport default class LanguageMgr{\r\n\r\n    private static lanDic    :SimpleDictionary = null;\r\n    private static hasSetup  :boolean = false;\r\n    private static nAllExp   :RegExp = /\\\\n/g;\r\n    private static paramReg  :RegExp = new RegExp(\"\\\\{(\\\\d+)\\\\}\");\r\n\r\n    //启动语言包加载\r\n    public static setup(callFun:Function):void {\r\n        cc.loader.loadRes(GameConst.LAN_PATH,function(err,res) {\r\n            if(err) {\r\n                cc.warn(\"lan load err\")\r\n                LanguageMgr.hasSetup = false;\r\n                callFun(false);\r\n                return;\r\n            };\r\n            LanguageMgr.analyzeLan(res,callFun);\r\n        });\r\n    }\r\n    //解析【语言包】【并存放到字典中，解析成功标识启动】\r\n    public static analyzeLan(res,callFun):void {\r\n        if(LanguageMgr.hasSetup) {\r\n            callFun(true);\r\n            return;\r\n        }\r\n        LanguageMgr.lanDic = new SimpleDictionary();\r\n        let languages = res.toString();\r\n        if(StringUtils.isNullOrUndefined(languages))return;\r\n        if(StringUtils.isEmptyString(languages))return;\r\n\r\n        let list:string[] = languages.split(\"\\n\");\r\n        for(let i:number = 0; i < list.length; i ++) {\r\n            let s:String = list[i];\r\n            if(s.indexOf(\"#\") == 0)continue;  //注：#开头表示标识，类似于注释   \r\n            s = s.replace(LanguageMgr.nAllExp,\"\\n\");\r\n            let index:number = s.indexOf(\":\");\r\n            if(index != -1) {\r\n                let key:string = s.substring(0,index);\r\n                let value:string = s.substr(index + 1);\r\n                value = value.split(\"##\")[0];\r\n                value = StringUtils.trimRight(value);\r\n                LanguageMgr.lanDic.addItem(key,value);\r\n            }\r\n        }\r\n        LanguageMgr.hasSetup = true;\r\n        callFun(true);\r\n    }\r\n\r\n    //获取【语言包】【根据key,以及匹配参数:0,1,2】\r\n    public static getTranslation(lanKey:string,...args:any):string{\r\n        if(!LanguageMgr.hasSetup)return \"\";\r\n        let lanValue = LanguageMgr.lanDic.getItem(lanKey);\r\n        if(lanValue == null)return \"\";\r\n\r\n        var obj:Object = LanguageMgr.paramReg.exec(lanValue);\r\n        while(obj && args.length > 0)\r\n        {\r\n            let id:number = obj[1] as number;\r\n            if(id >= 0 && id < args.length)\r\n            {\r\n                lanValue =lanValue.replace(LanguageMgr.paramReg,args[id]);\r\n            }\r\n            else\r\n            {\r\n                lanValue = lanValue.replace(LanguageMgr.paramReg,\"{}\");\r\n            }\r\n            obj = LanguageMgr.paramReg.exec(lanValue);\r\n        }\r\n        return lanValue;\r\n    }\r\n}"]}