{"version":3,"sources":["assets\\Script\\game\\role\\roleSpine.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAAA,+CAAyD;AACzD,mEAA8D;AAC9D,+CAA0C;AAC1C,8CAAyC;AACzC,6DAAwD;AAElD,IAAA,kBAAmC,EAAlC,oBAAO,EAAE,sBAAyB,CAAC;AAG1C;IAAuC,6BAAY;IADnD;QAAA,qEAiTC;QA7SG,WAAK,GAAW,IAAI,CAAC;QAIb,aAAO,GAAU,CAAC,CAAC;QACnB,eAAS,GAAU,CAAC,CAAC;QACrB,YAAM,GAAU,sBAAU,CAAC,IAAI,CAAC;QAEhC,gBAAU,GAAG,EAAE,CAAC,CAAA,UAAU;QAC1B,eAAS,GAAG,EAAE,CAAC,CAAA,UAAU;QACzB,eAAS,GAAG,EAAE,CAAC,CAAC,UAAU;QAC1B,eAAS,GAAG,EAAE,CAAC,CAAA,UAAU;QAEzB,gBAAU,GAAU,CAAC,CAAC,CAAA,SAAS;QAC/B,iBAAW,GAAU,CAAC,CAAC,CAAA,SAAS;QAChC,iBAAW,GAAU,CAAC,CAAC;QAEvB,cAAQ,GAAU,CAAC,CAAC;QACpB,mBAAa,GAAU,CAAC,CAAC;QACzB,oBAAc,GAAU,CAAC,CAAC;QAC1B,oBAAc,GAAU,CAAC,CAAC;QAE1B,iBAAW,GAAU,CAAC,CAAC;QAEvB,YAAM,GAAW,IAAI,CAAC;QAEtB,eAAS,GAAW,IAAI,CAAC;QAGzB,YAAM,GAAW,KAAK,CAAC;;IAgRnC,CAAC;IA9QG,0BAAM,GAAN;QAEI,IAAI,CAAC,EAAE,GAAG,IAAI,CAAC,YAAY,CAAC,EAAE,CAAC,QAAQ,CAAC,CAAC;QAEzC,QAAQ;QACR,KAAK,IAAI,GAAG,IAAI,IAAI,CAAC,EAAE,CAAC,WAAW,CAAC,CAAC,IAAI,CAAC,UAAU,EACpD;YACI,IAAI,SAAS,GAAG,IAAI,CAAC,EAAE,CAAC,WAAW,CAAC,CAAC,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,CAAC;YAC1D,IAAI,CAAC,UAAU,CAAC,SAAS,CAAC,IAAI,CAAC,GAAG;gBAC9B,UAAU,EAAG,QAAQ,CAAC,GAAG,CAAC;gBAC1B,IAAI,EAAS,SAAS,CAAC,IAAI;gBAC3B,QAAQ,EAAK,SAAS,CAAC,QAAQ;aAClC,CAAC;SACL;QAED,KAAK,IAAI,GAAG,IAAI,IAAI,CAAC,EAAE,CAAC,WAAW,CAAC,CAAC,IAAI,CAAC,KAAK,EAC/C;YACI,IAAI,QAAQ,GAAG,IAAI,CAAC,EAAE,CAAC,WAAW,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;YACpD,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,IAAI,CAAC,GAAG;gBAC5B,KAAK,EAAU,QAAQ,CAAC,KAAK;gBAC7B,CAAC,EAAc,QAAQ,CAAC,CAAC;gBACzB,CAAC,EAAc,QAAQ,CAAC,CAAC;gBACzB,YAAY,EAAG,KAAK;aACvB,CAAC;SACL;QAED,KAAK,IAAI,GAAG,IAAI,IAAI,CAAC,EAAE,CAAC,WAAW,CAAC,CAAC,IAAI,CAAC,KAAK,EAC/C;YACI,IAAI,QAAQ,GAAG,IAAI,CAAC,EAAE,CAAC,WAAW,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;YACpD,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,IAAI,CAAC,GAAG;gBAC5B,IAAI,EAAW,QAAQ,CAAC,IAAI;gBAC5B,KAAK,EAAU,EAAE;gBACjB,WAAW,EAAI,EAAE;aACpB,CAAC;SACL;QAED,KAAK,IAAI,GAAG,IAAI,IAAI,CAAC,EAAE,CAAC,WAAW,CAAC,CAAC,IAAI,CAAC,KAAK,EAC/C;YACI,IAAI,SAAS,GAAG,IAAI,CAAC,EAAE,CAAC,WAAW,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;YACrD,IAAI,CAAC,SAAS,CAAC,SAAS,CAAC,IAAI,CAAC,GAAG;gBAC7B,KAAK,EAAU,SAAS,CAAC,KAAK;gBAC9B,IAAI,EAAW,SAAS,CAAC,IAAI;gBAC7B,QAAQ,EAAO,IAAI;aACtB,CAAC;SACL;QAGD,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,IAAI,EAAC,CAAC,CAAC,CAAC;IACnC,CAAC;IAED,wBAAI,GAAJ;QAEI,IAAI,CAAC,KAAK,CAAC,MAAM,GAAG,CAAC,CAAC;QACtB,IAAI,CAAC,SAAS,GAAG,qBAAS,CAAC,IAAI,CAAC;QAChC,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC,CAAC,UAAU,CAAC;QAErD,IAAI,CAAC,GAAG,GAAG,IAAI,CAAC,EAAE,CAAC,QAAQ,CAAC,YAAY,CAAC,CAAC;QAC1C,IAAI,CAAC,MAAM,GAAG,EAAE,CAAC,EAAE,CAAC,IAAI,CAAC,GAAG,CAAC,MAAM,EAAE,IAAI,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;QACtD,IAAI,CAAC,WAAW,GAAG,mBAAS,CAAC,gBAAgB,CAAC,IAAI,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;QAEjE,IAAI,CAAC,aAAa,GAAG,CAAC,EAAE,CAAC;QACzB,IAAI,CAAC,cAAc,GAAG,mBAAS,CAAC,gBAAgB,CAAC,IAAI,CAAC,aAAa,GAAG,EAAE,CAAC,CAAC;QAC1E,IAAI,CAAC,cAAc,GAAG,mBAAS,CAAC,gBAAgB,CAAC,IAAI,CAAC,aAAa,GAAG,EAAE,CAAC,CAAC;QAE1E,IAAI,CAAC,UAAU,EAAE,CAAC;QAClB,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;QAE/B,IAAI,CAAC,EAAE,CAAC,MAAM,CAAC,KAAK,EAAE,SAAS,EAAE,GAAG,CAAC,CAAC;QACtC,IAAI,CAAC,EAAE,CAAC,MAAM,CAAC,KAAK,EAAE,SAAS,EAAE,GAAG,CAAC,CAAC;QACtC,IAAI,CAAC,EAAE,CAAC,MAAM,CAAC,MAAM,EAAE,SAAS,EAAE,GAAG,CAAC,CAAC;QACvC,IAAI,CAAC,EAAE,CAAC,MAAM,CAAC,MAAM,EAAE,SAAS,EAAE,GAAG,CAAC,CAAC;QAEvC,IAAI,CAAC,EAAE,CAAC,gBAAgB,CAAC,UAAU,UAAU;YAEzC,IAAI,aAAa,GAAG,UAAU,CAAC,SAAS,CAAC,CAAC,CAAC,UAAU,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC;YAC1E,QAAQ,aAAa,EAAE;gBACnB,KAAK,SAAS;oBACV,MAAM;aACb;QACL,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;QACd,IAAI,CAAC,EAAE,CAAC,mBAAmB,CAAC,UAAU,UAAU;YAE5C,IAAI,aAAa,GAAG,UAAU,CAAC,SAAS,CAAC,CAAC,CAAC,UAAU,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC;YAC1E,QAAQ,aAAa,EAAE;gBACnB,KAAK,SAAS,CAAC;gBACf,KAAK,SAAS;oBACV,IAAI,CAAC,EAAE,CAAC,UAAU,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;oBACrC,IAAI,CAAC,YAAY,CAAC,qBAAS,CAAC,IAAI,CAAC,CAAC;oBAClC,MAAM;aACb;QACL,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;QACd,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC;QAEnB,IAAI,CAAC,QAAQ,EAAE,CAAC;QAChB,sBAAY,CAAC,cAAc,CAAC,mBAAS,CAAC,YAAY,CAAC,CAAC;IAExD,CAAC;IAED,4BAAQ,GAAR;QAEI,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,aAAa,EAAC,IAAI,CAAC,WAAW,EAAC,IAAI,CAAC,CAAC;QAClD,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,WAAW,EAAC,IAAI,CAAC,eAAe,EAAC,IAAI,CAAC,CAAC;QACpD,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,YAAY,EAAE,IAAI,CAAC,UAAU,EAAE,IAAI,CAAC,CAAC;QAClD,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,OAAO,EAAE,IAAI,CAAC,UAAU,EAAE,IAAI,CAAC,CAAC;QAC7C,sBAAY,CAAC,WAAW,CAAC,mBAAS,CAAC,SAAS,EAAC,IAAI,EAAC,IAAI,CAAC,gBAAgB,CAAC,CAAC;IAC7E,CAAC;IAED,6BAAS,GAAT;QAEI,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,aAAa,EAAC,IAAI,CAAC,WAAW,EAAC,IAAI,CAAC,CAAC;QACnD,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,WAAW,EAAC,IAAI,CAAC,eAAe,EAAC,IAAI,CAAC,CAAC;QACrD,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,YAAY,EAAE,IAAI,CAAC,UAAU,EAAE,IAAI,CAAC,CAAC;QACnD,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,OAAO,EAAE,IAAI,CAAC,UAAU,EAAE,IAAI,CAAC,CAAC;QAC9C,sBAAY,CAAC,cAAc,CAAC,mBAAS,CAAC,SAAS,EAAC,IAAI,EAAC,IAAI,CAAC,gBAAgB,CAAC,CAAC;IAChF,CAAC;IAED,gCAAY,GAAZ,UAAa,KAAK;QAEd,IAAG,IAAI,CAAC,EAAE,CAAC,SAAS,IAAI,KAAK;YAAC,OAAO;QACrC,QAAQ,KAAK,EACb;YACI,KAAK,sBAAU,CAAC,IAAI,EAAE,IAAI;gBACtB,IAAI,CAAC,EAAE,CAAC,UAAU,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;gBACpC,IAAI,CAAC,EAAE,CAAC,UAAU,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;gBACrC,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC,CAAC,UAAU,CAAC;gBACrD,IAAI,CAAC,EAAE,CAAC,YAAY,CAAC,IAAI,CAAC,UAAU,EAAE,MAAM,EAAE,IAAI,CAAC,CAAC;gBACpD,MAAM;YACV,KAAK,sBAAU,CAAC,GAAG,EAAC,IAAI;gBACpB,IAAI,CAAC,EAAE,CAAC,UAAU,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;gBACpC,IAAI,CAAC,EAAE,CAAC,UAAU,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;gBACrC,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC,CAAC,UAAU,CAAC;gBACpD,IAAI,CAAC,EAAE,CAAC,YAAY,CAAC,IAAI,CAAC,UAAU,EAAE,KAAK,EAAE,IAAI,CAAC,CAAC;gBACnD,MAAM;YACV,KAAK,sBAAU,CAAC,IAAI,EAAC,IAAI;gBACrB,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC;gBACrB,IAAI,CAAC,EAAE,CAAC,UAAU,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;gBACpC,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC,CAAC,UAAU,CAAC;gBACrD,IAAI,CAAC,EAAE,CAAC,YAAY,CAAC,IAAI,CAAC,UAAU,EAAE,MAAM,EAAE,IAAI,CAAC,CAAC;gBACpD,MAAM;YACV,KAAK,sBAAU,CAAC,MAAM,EAAE,IAAI;gBACxB,IAAI,CAAC,EAAE,CAAC,UAAU,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;gBACrC,IAAI,IAAI,CAAC,UAAU,IAAI,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC,CAAC,UAAU;uBAClD,IAAI,CAAC,UAAU,IAAI,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC,CAAC,UAAU,EAC5D;oBACI,IAAI,CAAC,EAAE,CAAC,UAAU,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;iBACvC;gBACD,IAAI,MAAM,GAAG,YAAY,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;gBAC5C,IAAI,MAAM,CAAC,QAAQ,IAAI,CAAC,EAAE;oBACtB,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,UAAU,CAAC,SAAS,CAAC,CAAC,UAAU,CAAC;oBACzD,IAAI,CAAC,EAAE,CAAC,YAAY,CAAC,IAAI,CAAC,WAAW,EAAE,SAAS,EAAE,KAAK,CAAC,CAAC;iBAC5D;qBACI,IAAI,MAAM,CAAC,QAAQ,IAAI,CAAC,EAAE;oBAC3B,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,UAAU,CAAC,SAAS,CAAC,CAAC,UAAU,CAAC;oBACzD,IAAI,CAAC,EAAE,CAAC,YAAY,CAAC,IAAI,CAAC,WAAW,EAAE,SAAS,EAAE,KAAK,CAAC,CAAC;iBAC5D;gBACD,MAAM;SACb;IACL,CAAC;IAED,+BAAW,GAAX,UAAa,KAAK;QAEd,IAAI,CAAC,SAAS,GAAG,KAAK,CAAC,CAAA,sBAAsB;QAC7C,QAAQ,KAAK,EACb;YACI,KAAK,CAAC,EAAE,IAAI;gBACR,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC;gBACrB,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;gBAC/B,MAAM;YACV,KAAK,CAAC,EAAC,IAAI;gBACP,IAAI,CAAC,MAAM,GAAG,KAAK,CAAC;gBACpB,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;gBAC/B,MAAM;YACV,KAAK,CAAC,EAAE,IAAI;gBACR,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC;gBACrB,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;gBAC/B,MAAM;SACb;IACL,CAAC;IAED,oCAAgB,GAAhB,UAAiB,GAAU,EAAC,GAAU;QAElC,IAAI,GAAG,GAAG,GAAc,CAAC;QACzB,IAAI,UAAU,GAAG,IAAI,CAAC,IAAI,CAAC,qBAAqB,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;QAC9D,IAAI,QAAQ,GAAG,mBAAS,CAAC,WAAW,CAAC,UAAU,EAAC,GAAG,CAAC,CAAC;QAErD,IAAI,IAAI,CAAC,IAAI,CAAC,MAAM,GAAG,CAAC,EACxB;YACI,QAAQ,GAAG,QAAQ,GAAG,EAAE,GAAG,YAAY,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC,QAAQ,CAAC;YACnE,QAAQ,GAAG,GAAG,GAAG,QAAQ,CAAC;SAC7B;aACI;YACD,QAAQ,GAAG,QAAQ,GAAG,EAAE,GAAG,YAAY,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC,QAAQ,CAAC;SACtE;QACD,QAAQ,GAAG,mBAAS,CAAC,gBAAgB,CAAC,QAAQ,CAAC,CAAC;QAChD,IAAI,mBAAS,CAAC,aAAa,CAAC,QAAQ,EAAE,IAAI,CAAC,cAAc,EAAE,IAAI,CAAC,cAAc,CAAC,EAC/E;YACI,IAAI,CAAC,GAAG,CAAC,QAAQ,GAAG,QAAQ,CAAC;YAC7B,IAAI,CAAC,WAAW,GAAG,mBAAS,CAAC,gBAAgB,CAAC,IAAI,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;SACpE;aAED;YACI,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,CAAA;SAC9C;IACL,CAAC;IAED,mCAAe,GAAf,UAAgB,KAAK;QAEjB,IAAI,CAAC,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,OAAO,GAAG,KAAK,CAAC;QACxC,IAAI,CAAC,KAAK,CAAC,MAAM,GAAG,IAAI,CAAC,OAAO,GAAG,KAAK,CAAC;IAC7C,CAAC;IAED,0BAAM,GAAN,UAAO,GAAG;QAEN,IAAG,CAAC,IAAI,CAAC,MAAM;YAAC,OAAO;QACvB,GAAG,CAAC,CAAC,IAAI,YAAY,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC,IAAI,CAAC;QAC7C,IAAI,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,qBAAqB,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;QACrD,IAAI,QAAQ,GAAG,mBAAS,CAAC,WAAW,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC;QAC7C,IAAI,IAAI,CAAC,IAAI,CAAC,MAAM,GAAG,CAAC,EACxB;YACI,QAAQ,GAAG,QAAQ,GAAG,EAAE,GAAG,YAAY,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC,QAAQ,CAAC;YACnE,QAAQ,GAAG,GAAG,GAAG,QAAQ,CAAA;SAC5B;aACI;YACD,QAAQ,GAAG,QAAQ,GAAG,EAAE,GAAG,YAAY,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC,QAAQ,CAAC;SACtE;QACD,QAAQ,GAAG,mBAAS,CAAC,gBAAgB,CAAC,QAAQ,CAAC,CAAC;QAChD,IAAI,mBAAS,CAAC,aAAa,CAAC,QAAQ,EAAE,IAAI,CAAC,cAAc,EAAE,IAAI,CAAC,cAAc,CAAC,EAC9E;YACG,IAAI,CAAC,GAAG,CAAC,QAAQ,GAAG,QAAQ,CAAC;YAC7B,IAAI,CAAC,WAAW,GAAG,mBAAS,CAAC,gBAAgB,CAAC,IAAI,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;SACpE;IACL,CAAC;IAED,SAAS;IACT,8BAAU,GAAV;QAEI,IAAI,CAAC,WAAW,IAAI,CAAC,CAAC;QACtB,IAAI,IAAI,CAAC,WAAW,GAAG,CAAC;YAAE,IAAI,CAAC,WAAW,GAAG,CAAC,CAAC;QAC/C,IAAI,MAAM,GAAG,YAAY,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;QAC5C,IAAI,CAAC,EAAE,CAAC,OAAO,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;QAC7B,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,EAAE,CAAC,QAAQ,CAAC,cAAc,GAAG,IAAI,CAAC,WAAW,CAAC,CAAC;QAClE,IAAI,CAAC,SAAS,GAAG,EAAE,CAAC,EAAE,CAAC,IAAI,CAAC,MAAM,CAAC,MAAM,EAAE,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC;QAC/D,IAAI,OAAO,GAAG,IAAI,CAAC,IAAI,CAAC,qBAAqB,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;IAClE,CAAC;IAED,0BAAM,GAAN,UAAQ,EAAE;QAEN,IAAG,qBAAW,CAAC,QAAQ,CAAC,MAAM;YAAE,OAAO;QACvC,IAAG,CAAC,IAAI,CAAC,MAAM;YAAC,OAAO;QACvB,IAAI,CAAC,QAAQ,IAAI,EAAE,CAAC;QACpB,IAAG,CAAC,qBAAW,CAAC,QAAQ,CAAC,SAAS;YAAC,OAAO;QAC1C,IAAI,MAAM,GAAG,YAAY,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;QAC5C,IAAG,IAAI,CAAC,QAAQ,GAAG,MAAM,CAAC,QAAQ,EAClC;YACI,IAAI,CAAC,QAAQ,GAAG,CAAC,CAAC;YAClB,IAAI,CAAC,YAAY,CAAC,qBAAS,CAAC,MAAM,CAAC,CAAC;YACpC,IAAI,UAAU,GAAG,IAAI,CAAC,IAAI,CAAC,qBAAqB,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;YAE9D,IAAI,aAAa,GAAG,IAAI,CAAC,IAAI,CAAC,qBAAqB,CAAC,EAAE,CAAC,EAAE,CAAC,IAAI,CAAC,MAAM,CAAC,MAAM,EAAE,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC,CAAC;YACnG,IAAI,QAAQ,GAAG,mBAAS,CAAC,WAAW,CAAC,UAAU,EAAE,aAAa,CAAC,CAAC;YAChE,gDAAgD;YAChD,IAAI,CAAC,IAAI,CAAC,SAAS;gBAAE,IAAI,CAAC,SAAS,GAAG,EAAE,CAAC;YACzC,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,GAAG,YAAY,CAAC,CAAA,OAAO;YACnD,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,GAAG,EAAE,CAAC,EAAE,CAAC,aAAa,CAAC,CAAC,GAAG,EAAE,EAAC,aAAa,CAAC,CAAC,CAAC,CAAC,CAAC,IAAI;YACvE,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,GAAG,QAAQ,CAAC,CAAA,OAAO;YAC1C,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,GAAG,QAAQ,CAAC,CAAC,GAAG;YACvC,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,GAAG,MAAM,CAAC,MAAM,CAAC;YACzC,sBAAY,CAAC,cAAc,CAAC,mBAAS,CAAC,YAAY,EAAC,IAAI,CAAC,SAAS,CAAC,CAAC;SACtE;IACL,CAAC;IA5SD;QADC,QAAQ,CAAC,EAAE,CAAC,IAAI,CAAC;4CACG;IAHJ,SAAS;QAD7B,OAAO;OACa,SAAS,CAgT7B;IAAD,gBAAC;CAhTD,AAgTC,CAhTsC,EAAE,CAAC,SAAS,GAgTlD;kBAhToB,SAAS;AAkT9B,IAAI,YAAY,GAAG;IACf,EAAE,EAAE,MAAM;IACV,GAAG,EAAE;QACD,IAAI,EAAE,UAAU;QAChB,QAAQ,EAAE,EAAE;QACZ,QAAQ,EAAE,GAAG;QACb,QAAQ,EAAE,CAAC;QACX,MAAM,EAAE,EAAE;QACV,GAAG,EAAE,CAAC;QACN,IAAI,EAAE,CAAC;KACV;IACD,GAAG,EAAE;QACD,IAAI,EAAE,UAAU;QAChB,QAAQ,EAAE,EAAE;QACZ,QAAQ,EAAE,GAAG;QACb,QAAQ,EAAE,CAAC;QACX,MAAM,EAAE,IAAI;QACZ,GAAG,EAAE,CAAC;QACN,IAAI,EAAE,CAAC;KACV;IACD,GAAG,EAAE;QACD,IAAI,EAAE,UAAU;QAChB,QAAQ,EAAE,EAAE;QACZ,QAAQ,EAAE,GAAG;QACb,QAAQ,EAAE,CAAC;QACX,MAAM,EAAE,GAAG;QACX,GAAG,EAAE,CAAC;QACN,IAAI,EAAE,CAAC,EAAE;KACZ;IACD,GAAG,EAAE;QACD,IAAI,EAAE,UAAU;QAChB,QAAQ,EAAE,EAAE;QACZ,QAAQ,EAAE,GAAG;QACb,QAAQ,EAAE,CAAC;QACX,MAAM,EAAE,GAAG;QACX,GAAG,EAAE,CAAC;QACN,IAAI,EAAE,CAAC;KACV,CAAA,KAAK;CACT,CAAA","file":"","sourceRoot":"/","sourcesContent":["import { RoleState ,RoleAction} from \"../data/GameConst\";\r\nimport MsgCallUtils from \"../../framewrok/utils/MsgCallUtils\";\r\nimport GameEvent from \"../data/GameEvent\";\r\nimport GameManager from \"../gameManager\";\r\nimport GameUtils from \"../../framewrok/utils/GameUtils\";\r\n\r\nconst {ccclass, property} = cc._decorator;\r\n\r\n@ccclass\r\nexport default class RoleSpine extends cc.Component {\r\n\r\n    @property(cc.Node)\r\n    hpBar:cc.Node = null;\r\n\r\n    private sp:sp.Skeleton;\r\n\r\n    private roleDir:number = 1;\r\n    private roleState:number = 0;\r\n    private action:string = RoleAction.idle;\r\n\r\n    private animations = {};//解析完的动画数据\r\n    private boneDatas = {};//解析完的动画数据\r\n    private skinDatas = {}; //解析完的动画数据\r\n    private slotDatas = {};//解析完的动画数据\r\n\r\n    private trackIndex:number = 0;//当前执行的动画\r\n    private trackIndex2:number = 0;//当前执行的动画\r\n    private weaponIndex:number = 0;\r\n\r\n    private sendTime:number = 0;\r\n    private rotationLimit:number = 0;\r\n    private rotationLimit1:number = 0;\r\n    private rotationLimit2:number = 0;\r\n\r\n    private armRotation:number = 0;\r\n    private arm:any;\r\n    private armPos:cc.Vec2 = null;\r\n    private weapon:any;\r\n    private weaponPos:cc.Vec2 = null;\r\n\r\n    private shootData:Object;\r\n    private isInit:boolean = false;\r\n\r\n    onLoad () \r\n    {\r\n        this.sp = this.getComponent(sp.Skeleton);\r\n        \r\n        //解析动画数据\r\n        for (let key in this.sp[\"_skeleton\"].data.animations) \r\n        {\r\n            let animation = this.sp[\"_skeleton\"].data.animations[key];\r\n            this.animations[animation.name] = {\r\n                trackIndex : parseInt(key),\r\n                name       : animation.name,\r\n                duration   : animation.duration\r\n            };\r\n        }\r\n\r\n        for (let key in this.sp[\"_skeleton\"].data.bones) \r\n        {\r\n            let boneData = this.sp[\"_skeleton\"].data.bones[key];\r\n            this.boneDatas[boneData.name] = {\r\n                index        : boneData.index,\r\n                x            : boneData.x,\r\n                y            : boneData.y,\r\n                skinRequired : false\r\n            };\r\n        }\r\n\r\n        for (let key in this.sp[\"_skeleton\"].data.skins) \r\n        {\r\n            let skinData = this.sp[\"_skeleton\"].data.skins[key];\r\n            this.skinDatas[skinData.name] = {\r\n                name         : skinData.name,\r\n                bones        : [],\r\n                attachments  : []\r\n            };\r\n        }\r\n\r\n        for (let key in this.sp[\"_skeleton\"].data.slots) \r\n        {\r\n            let slotsData = this.sp[\"_skeleton\"].data.slots[key];\r\n            this.boneDatas[slotsData.name] = {\r\n                index        : slotsData.index,\r\n                name         : slotsData.name,\r\n                boneData     : null, //对应boneData\r\n            };\r\n        }\r\n        \r\n        \r\n        this.scheduleOnce(this.init,1);\r\n    }\r\n\r\n    init()\r\n    {\r\n        this.hpBar.scaleX = 1;\r\n        this.roleState = RoleState.idel;\r\n        this.trackIndex = this.animations[\"idle\"].trackIndex;\r\n\r\n        this.arm = this.sp.findBone(\"root_qiang\");\r\n        this.armPos = cc.v2(this.arm.worldX, this.arm.worldY);\r\n        this.armRotation = GameUtils.standardRotation(this.arm.rotation);\r\n\r\n        this.rotationLimit = -65;\r\n        this.rotationLimit1 = GameUtils.standardRotation(this.rotationLimit - 90);\r\n        this.rotationLimit2 = GameUtils.standardRotation(this.rotationLimit + 90);\r\n\r\n        this.switchSkin();\r\n        this.changeAction(this.action);\r\n\r\n        this.sp.setMix('run', 'attack2', 0.1);\r\n        this.sp.setMix('run', 'attack1', 0.1);\r\n        this.sp.setMix('idle', 'attack2', 0.2);\r\n        this.sp.setMix('idle', 'attack1', 0.2);\r\n    \r\n        this.sp.setStartListener(function (trackEntry) \r\n        {\r\n            let animationName = trackEntry.animation ? trackEntry.animation.name : \"\";\r\n            switch (animationName) {\r\n                case \"attack1\":\r\n                    break;\r\n            }\r\n        }.bind(this));\r\n        this.sp.setCompleteListener(function (trackEntry) \r\n        {\r\n            let animationName = trackEntry.animation ? trackEntry.animation.name : \"\";\r\n            switch (animationName) {\r\n                case \"attack1\":\r\n                case \"attack2\":\r\n                    this.sp.clearTrack(this.trackIndex2);\r\n                    this.changeAction(RoleState.idel);\r\n                    break;\r\n            }\r\n        }.bind(this));\r\n        this.isInit = true;\r\n\r\n        this.addEvent();\r\n        MsgCallUtils.notifyObserver(GameEvent.SPINE_INITED);\r\n\r\n    }\r\n\r\n    addEvent()\r\n    {\r\n        this.node.on(\"changeState\",this.changeState,this);\r\n        this.node.on(\"changeDir\",this.changeDirection,this);\r\n        this.node.on(\"switchSkin\", this.switchSkin, this);\r\n        this.node.on(\"fight\", this.switchSkin, this);\r\n        MsgCallUtils.addObserver(GameEvent.TOUCH_MAP,this,this.touchDownHandler);\r\n    }\r\n\r\n    onDestroy()\r\n    {\r\n        this.node.off(\"changeState\",this.changeState,this);\r\n        this.node.off(\"changeDir\",this.changeDirection,this);\r\n        this.node.off(\"switchSkin\", this.switchSkin, this);\r\n        this.node.off(\"fight\", this.switchSkin, this);\r\n        MsgCallUtils.removeObserver(GameEvent.TOUCH_MAP,this,this.touchDownHandler);\r\n    }\r\n\r\n    changeAction(value)\r\n    {\r\n        if(this.sp.animation == value)return;\r\n        switch (value) \r\n        {\r\n            case RoleAction.idle: //静止\r\n                this.sp.clearTrack(this.trackIndex);\r\n                this.sp.clearTrack(this.trackIndex2);\r\n                this.trackIndex = this.animations[\"idle\"].trackIndex;\r\n                this.sp.addAnimation(this.trackIndex, \"idle\", true);\r\n                break;\r\n            case RoleAction.run://移动\r\n                this.sp.clearTrack(this.trackIndex);\r\n                this.sp.clearTrack(this.trackIndex2);\r\n                this.trackIndex = this.animations[\"run\"].trackIndex;\r\n                this.sp.addAnimation(this.trackIndex, \"run\", true);\r\n                break;\r\n            case RoleAction.jump://跳跃\r\n                this.action = \"jump\";\r\n                this.sp.clearTrack(this.trackIndex);\r\n                this.trackIndex = this.animations[\"jump\"].trackIndex;\r\n                this.sp.addAnimation(this.trackIndex, \"jump\", true);\r\n                break;\r\n            case RoleAction.attack: //攻击\r\n                this.sp.clearTrack(this.trackIndex2);\r\n                if (this.trackIndex == this.animations[\"idle\"].trackIndex \r\n                    || this.trackIndex == this.animations[\"jump\"].trackIndex) \r\n                {\r\n                    this.sp.clearTrack(this.trackIndex);\r\n                }\r\n                let weapon = weaponConfig[this.weaponIndex];\r\n                if (weapon.attackId == 1) {\r\n                    this.trackIndex2 = this.animations[\"attack1\"].trackIndex;\r\n                    this.sp.addAnimation(this.trackIndex2, \"attack1\", false);\r\n                }\r\n                else if (weapon.attackId == 2) {\r\n                    this.trackIndex2 = this.animations[\"attack2\"].trackIndex;\r\n                    this.sp.addAnimation(this.trackIndex2, \"attack2\", false);\r\n                }\r\n                break;\r\n        }\r\n    }\r\n\r\n    changeState (value) \r\n    {\r\n        this.roleState = value;//角色状态  0=静止 1=移动 2=跳跃\r\n        switch (value) \r\n        {\r\n            case 0: //静止\r\n                this.action = \"idle\";\r\n                this.changeAction(this.action);\r\n                break;\r\n            case 1://移动\r\n                this.action = \"run\";\r\n                this.changeAction(this.action);\r\n                break;\r\n            case 2: //跳跃\r\n                this.action = \"jump\";\r\n                this.changeAction(this.action);\r\n                break;\r\n        }\r\n    }\r\n\r\n    touchDownHandler(msg:string,obj:object)\r\n    {\r\n        let pos = obj as cc.Vec2;\r\n        let realArmPos = this.node.convertToWorldSpaceAR(this.armPos);\r\n        let rotation = GameUtils.getRotation(realArmPos,pos);\r\n\r\n        if (this.node.scaleX < 0) \r\n        {\r\n            rotation = rotation - 90 - weaponConfig[this.weaponIndex].rotation;\r\n            rotation = 360 - rotation;\r\n        }\r\n        else {\r\n            rotation = rotation - 90 + weaponConfig[this.weaponIndex].rotation;\r\n        }\r\n        rotation = GameUtils.standardRotation(rotation);\r\n        if (GameUtils.limitRotation(rotation, this.rotationLimit1, this.rotationLimit2)) \r\n        {\r\n            this.arm.rotation = rotation;\r\n            this.armRotation = GameUtils.standardRotation(this.arm.rotation);\r\n        }\r\n        else \r\n        {\r\n            this.changeDirection(this.node.scaleX * -1)\r\n        }\r\n    }\r\n\r\n    changeDirection(value) \r\n    {\r\n        this.node.scaleX = this.roleDir * value;\r\n        this.hpBar.scaleX = this.roleDir * value;\r\n    }\r\n\r\n    aimPos(pos) \r\n    {\r\n        if(!this.isInit)return;\r\n        pos.y += weaponConfig[this.weaponIndex].aimY;\r\n        let p = this.node.convertToWorldSpaceAR(this.armPos);\r\n        let rotation = GameUtils.getRotation(p, pos);\r\n        if (this.node.scaleX < 0) \r\n        {\r\n            rotation = rotation - 90 - weaponConfig[this.weaponIndex].rotation;\r\n            rotation = 360 - rotation\r\n        }\r\n        else {\r\n            rotation = rotation - 90 + weaponConfig[this.weaponIndex].rotation;\r\n        }\r\n        rotation = GameUtils.standardRotation(rotation);\r\n        if (GameUtils.limitRotation(rotation, this.rotationLimit1, this.rotationLimit2))\r\n         {\r\n            this.arm.rotation = rotation;\r\n            this.armRotation = GameUtils.standardRotation(this.arm.rotation);\r\n        }\r\n    }\r\n\r\n    //切换皮肤 武器\r\n    switchSkin() \r\n    {\r\n        this.weaponIndex += 1;\r\n        if (this.weaponIndex > 4) this.weaponIndex = 1;\r\n        let weapon = weaponConfig[this.weaponIndex];\r\n        this.sp.setSkin(weapon.name);\r\n        this.weapon = this.sp.findBone(\"root_weapons\" + this.weaponIndex);\r\n        this.weaponPos = cc.v2(this.weapon.worldX, this.weapon.worldY);\r\n        let testPos = this.node.convertToWorldSpaceAR(this.weaponPos);\r\n    }\r\n\r\n    update (dt) \r\n    {\r\n        if(GameManager.instance.isOver) return;\r\n        if(!this.isInit)return;\r\n        this.sendTime += dt;\r\n        if(!GameManager.instance.touchDown)return;\r\n        let weapon = weaponConfig[this.weaponIndex];\r\n        if(this.sendTime > weapon.sendTime)\r\n        {\r\n            this.sendTime = 0;\r\n            this.changeAction(RoleState.attack);\r\n            let realArmPos = this.node.convertToWorldSpaceAR(this.armPos);\r\n\r\n            let realWeaponPos = this.node.convertToWorldSpaceAR(cc.v2(this.weapon.worldX, this.weapon.worldY));\r\n            let rotation = GameUtils.getRotation(realArmPos, realWeaponPos);\r\n            // let bulletName = \"bullet\" + this.weaponIndex;\r\n            if (!this.shootData) this.shootData = {};\r\n            this.shootData[\"prefabName\"] = \"roleBullte\";//预制体名称\r\n            this.shootData[\"v\"] = cc.v2(realWeaponPos.x - 12,realWeaponPos.y); //位置\r\n            this.shootData[\"angle\"] = rotation;//角度cc.\r\n            this.shootData[\"group\"] = \"mybull\"; //组\r\n            this.shootData[\"attack\"] = weapon.attack;\r\n            MsgCallUtils.notifyObserver(GameEvent.PLAYER_SHOOT,this.shootData);\r\n        }\r\n    }\r\n}\r\n\r\nvar weaponConfig = {\r\n    hp: 300000, //初始血量\r\n    \"1\": {\r\n        name: \"weapons1\", //武器皮肤名称\r\n        rotation: 20,\r\n        sendTime: 0.3,//子弹发射时间\r\n        attackId: 1,//攻击动作id\r\n        attack: 10,//攻击力\r\n        bid: 1,\r\n        aimY: 0\r\n    },//手枪\r\n    \"2\": {\r\n        name: \"weapons2\",\r\n        rotation: 22,\r\n        sendTime: 0.6,\r\n        attackId: 2,\r\n        attack: 3000,\r\n        bid: 1,\r\n        aimY: 0\r\n    },//来福枪\r\n    \"3\": {\r\n        name: \"weapons3\",\r\n        rotation: 25,\r\n        sendTime: 0.6,\r\n        attackId: 2,\r\n        attack: 120, //\r\n        bid: 1,\r\n        aimY: -50\r\n    },//闪电枪\r\n    \"4\": {\r\n        name: \"weapons4\",\r\n        rotation: 25,\r\n        sendTime: 0.6, //子弹发射时间\r\n        attackId: 2,   //攻击动作id\r\n        attack: 180,  //攻击力\r\n        bid: 1,       //子弹id\r\n        aimY: 0\r\n    }//火箭筒\r\n}\r\n\r\n"]}