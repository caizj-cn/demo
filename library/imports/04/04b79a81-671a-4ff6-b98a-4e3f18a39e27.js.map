{"version":3,"sources":["assets\\Script\\game\\role\\roleLayer.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAAA,8CAAyC;AAGzC,+CAA0C;AAC1C,yCAAoC;AAE9B,IAAA,kBAAmC,EAAlC,oBAAO,EAAE,sBAAyB,CAAC;AAG1C;IAAuC,6BAAY;IADnD;QAAA,qEA6DC;QAzDG,kBAAY,GAAY,IAAI,CAAC;QAE7B,iBAAW,GAAa,IAAI,CAAC;QAE7B,oBAAc,GAAU,EAAE,CAAC;QAEnB,eAAS,GAAU,CAAC,CAAC;QAErB,oBAAc,GAAU,CAAC,CAAC;QAC1B,eAAS,GAAG,EAAE,CAAC;QACf,eAAS,GAAe,IAAI,CAAC;;IA+CzC,CAAC;IA7CG,0BAAM,GAAN;QAEI,IAAI,CAAC,SAAS,GAAG,mBAAS,CAAC,SAAS,CAAC;QACrC,IAAI,CAAC,SAAS,GAAG,IAAI,EAAE,CAAC,QAAQ,CAAC,mBAAS,CAAC,CAAC;QAC5C,KAAK,IAAI,KAAK,GAAG,CAAC,EAAE,KAAK,GAAG,IAAI,CAAC,cAAc,EAAE,KAAK,EAAE,EACxD;YACI,IAAI,KAAK,GAAG,EAAE,CAAC,WAAW,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;YAC7C,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;SAC7B;IACL,CAAC;IAED,yBAAK,GAAL;IAGA,CAAC;IAED,0BAAM,GAAN,UAAQ,EAAE;QAEN,OAAO;QACP,IAAG,qBAAW,CAAC,QAAQ,CAAC,MAAM;YAAC,OAAO;QACtC,IAAI,CAAC,SAAS,IAAI,EAAE,CAAC;QACrB,IAAG,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,cAAc;YAAC,OAAO;QAC/C,IAAI,SAAS,GAAG,IAAI,CAAC,SAAS,CAAC,KAAK,EAAE,CAAC;QACvC,IAAI,CAAC,WAAW,CAAC,SAAS,CAAC,CAAC;QAC5B,IAAI,CAAC,SAAS,GAAG,CAAC,CAAC;IACvB,CAAC;IAED,+BAAW,GAAX,UAAY,SAAgB;QAExB,IAAI,SAAS,CAAC;QACd,IAAI,IAAI,CAAC,SAAS,CAAC,IAAI,EAAE,GAAG,CAAC,EAC7B;YACI,SAAS,GAAG,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,mBAAS,CAAC,CAAC;SAC7C;aAED,EAAE,+CAA+C;YAC7C,SAAS,GAAG,EAAE,CAAC,WAAW,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;YAC7C,kBAAkB;YAClB,IAAI,eAAe,GAAG,SAAS,CAAC,YAAY,CAAC,mBAAS,CAAC,CAAC;YACxD,eAAe,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC;SACpC;QACD,SAAS,CAAC,CAAC,GAAG,IAAI,CAAC,YAAY,CAAC,CAAC,CAAC;QAClC,SAAS,CAAC,CAAC,GAAG,IAAI,CAAC,YAAY,CAAC,CAAC,CAAC;QAClC,SAAS,CAAC,MAAM,GAAG,IAAI,CAAC,IAAI,CAAC;IACjC,CAAC;IAxDD;QADC,QAAQ,CAAC,EAAE,CAAC,IAAI,CAAC;mDACW;IAE7B;QADC,QAAQ,CAAC,EAAE,CAAC,MAAM,CAAC;kDACS;IAE7B;QADC,QAAQ;qDACkB;IAPV,SAAS;QAD7B,OAAO;OACa,SAAS,CA4D7B;IAAD,gBAAC;CA5DD,AA4DC,CA5DsC,EAAE,CAAC,SAAS,GA4DlD;kBA5DoB,SAAS","file":"","sourceRoot":"/","sourcesContent":["import GameManager from \"../gameManager\";\r\nimport MsgCallUtils from \"../../framewrok/utils/MsgCallUtils\";\r\nimport GameEvent from \"../data/GameEvent\";\r\nimport EnemyData from \"../data/EnemyData\";\r\nimport EnemyRole from \"./EnemyRole\";\r\n\r\nconst {ccclass, property} = cc._decorator;\r\n\r\n@ccclass\r\nexport default class RoleLayer extends cc.Component {\r\n\r\n    @property(cc.Node)\r\n    enemyFactory: cc.Node = null;\r\n    @property(cc.Prefab)\r\n    enemyPrefab:cc.Prefab = null;\r\n    @property\r\n    deltaEnemyTime:number = 10;\r\n\r\n    private timeCount:number = 0;\r\n\r\n    private enemyInitCount:number = 5;\r\n    private enemyList = [];\r\n    private enemyPool:cc.NodePool = null;\r\n\r\n    onLoad()\r\n    {\r\n        this.enemyList = EnemyData.enemyList;\r\n        this.enemyPool = new cc.NodePool(EnemyRole);\r\n        for (let index = 0; index < this.enemyInitCount; index++) \r\n        {\r\n            let enemy = cc.instantiate(this.enemyPrefab);\r\n            this.enemyPool.put(enemy);\r\n        }\r\n    }\r\n\r\n    start () \r\n    {\r\n\r\n    }\r\n\r\n    update (dt) \r\n    {\r\n        return;\r\n        if(GameManager.instance.isOver)return;\r\n        this.timeCount += dt;\r\n        if(this.timeCount < this.deltaEnemyTime)return;\r\n        let enemyInfo = this.enemyList.shift();\r\n        this.createEnemy(enemyInfo);\r\n        this.timeCount = 0;       \r\n    }\r\n\r\n    createEnemy(enemyInfo:object)\r\n    {\r\n        let enemyRole;\r\n        if (this.enemyPool.size() > 0)\r\n        {\r\n            enemyRole = this.enemyPool.get(EnemyRole);\r\n        } \r\n        else \r\n        { // 如果没有空闲对象，就用 cc.instantiate 重新创建,这里未调用reuse方法\r\n            enemyRole = cc.instantiate(this.enemyPrefab);\r\n            //可以用下面方式调用reuse方法\r\n            let bulletComponent = enemyRole.getComponent(EnemyRole);\r\n            bulletComponent.reuse(enemyInfo);\r\n        }\r\n        enemyRole.x = this.enemyFactory.x;\r\n        enemyRole.y = this.enemyFactory.y;\r\n        enemyRole.parent = this.node;\r\n    }\r\n}\r\n"]}