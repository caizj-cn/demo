{"version":3,"sources":["assets\\Script\\game\\hall.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import LocalStorage from \"../framewrok/LocalStorage\";\r\nimport GameManager from \"./gameManager\";\r\nimport ChapterInfo from \"./data/ChapterData\";\r\nimport ChapterData from \"./data/ChapterData\";\r\nimport UIViewControl from \"../framewrok/UIViewControl\";\r\nimport MsgCallUtils from \"../framewrok/utils/MsgCallUtils\";\r\nimport UIConfig from \"./data/UIConfig\";\r\nimport GameEvent from \"./data/GameEvent\";\r\n\r\nconst {ccclass, property} = cc._decorator;\r\n\r\n@ccclass\r\nexport default class Hall extends cc.Component \r\n{\r\n    @property(cc.Node)\r\n    scrollContent:cc.Node = null;\r\n    @property(cc.Label)\r\n    chatperText:cc.Label= null;\r\n    @property(cc.Node)\r\n    heroHead:cc.Node= null;\r\n    @property(cc.Prefab)\r\n    itemPrefab:cc.Prefab= null;\r\n\r\n    itemBgAltas:cc.SpriteAtlas = null;\r\n    nodeList = [];\r\n\r\n    onLoad () \r\n    {\r\n        let chapterNum = LocalStorage.instance.getItem(\"chapter_num\");\r\n        if(!chapterNum)\r\n        {\r\n            chapterNum = GameManager.instance.chapterNum;\r\n            LocalStorage.instance.setItem(\"chapter_num\",chapterNum);\r\n        }\r\n        let nodeIndex = LocalStorage.instance.getItem(\"chapter_node_index\");\r\n        if(!nodeIndex)\r\n        {\r\n            nodeIndex = GameManager.instance.chapterNodeIndex;\r\n            LocalStorage.instance.setItem(\"chapter_node_index\",nodeIndex);\r\n        }\r\n        this.chatperText.string = \"第\" + chapterNum + \"章\";\r\n        this.nodeList = ChapterData.getNodeList(chapterNum);\r\n        this.loadPlist();\r\n      \r\n    }\r\n\r\n    loadPlist() {\r\n        let self = this;\r\n        cc.loader.loadRes(\"plist/ui\",cc.SpriteAtlas,function(err,res)\r\n        {\r\n            if(err)\r\n            {\r\n                cc.log(\"uiPlist load error\")\r\n                return;\r\n            }\r\n            self.itemBgAltas = res;\r\n            self.initScrollView();\r\n        });\r\n    }\r\n\r\n    initScrollView ()\r\n    {\r\n        for (let index = 0; index < this.nodeList.length; index++) \r\n        {\r\n            let nodeInfo = this.nodeList[index];\r\n            let nodeItem = cc.instantiate(this.itemPrefab);\r\n            let nodeScript = nodeItem.getComponent(\"chapterItem\");\r\n            nodeScript.setData(nodeInfo,this.itemBgAltas);\r\n            nodeItem.x = nodeInfo.x;\r\n            nodeItem.y = nodeInfo.y;\r\n            if(GameManager.instance.chapterNodeIndex == index + 1){\r\n                this.heroHead.x = nodeItem.x;\r\n                this.heroHead.y = nodeItem.y + 90;\r\n            }\r\n            nodeItem.parent = this.scrollContent;           \r\n        }\r\n    }\r\n\r\n    start () \r\n    {\r\n        \r\n    }\r\n\r\n    onPreClick(evt) \r\n    {\r\n        cc.log(\"waiting for chapter edit\");\r\n    }\r\n\r\n    onNextClick(evt) \r\n    {\r\n        cc.log(\"waiting for chapter edit\");\r\n    }\r\n\r\n    onSettingClick(evt) \r\n    {\r\n        let info = UIConfig.getUIInfo(\"winUI\");\r\n        MsgCallUtils.notifyObserver(GameEvent.SHOW_UIVIEW,info);\r\n    }\r\n\r\n}\r\n"]}